from matplotlib import pyplot as plt
from matplotlib.path import Path
from matplotlib.patches import PathPatch

import numpy
import geopandas as gpd
from shapely.wkt import loads
import cartagen4py as c4

buildings = [loads('Polygon ((395038.70000000001164153 6272970.90000000037252903, 395030.40000000002328306 6272984, 395025.29999999998835847 6272982, 395023.20000000001164153 6272983.70000000018626451, 395020 6272981.29999999981373549, 395016.90000000002328306 6272985.90000000037252903, 395021.79999999998835847 6272990.70000000018626451, 395020.59999999997671694 6272993.70000000018626451, 395024.70000000001164153 6272997.20000000018626451, 395028.5 6272994.5, 395032.79999999998835847 6272988.20000000018626451, 395038.09999999997671694 6272991.59999999962747097, 395044.90000000002328306 6272979.09999999962747097, 395047.09999999997671694 6272980.40000000037252903, 395049.5 6272976.79999999981373549, 395038.70000000001164153 6272970.90000000037252903))'), loads('Polygon Z ((394999.5 6272975, 395006.70000000001164153 6272962.40000000037252903, 395010.59999999997671694 6272957.5, 394996.59999999997671694 6272944.40000000037252903, 394991 6272949, 394999.20000000001164153 6272956.29999999981373549, 394996.09999999997671694 6272959.70000000018626451, 394998.29999999998835847 6272961.29999999981373549, 394992 6272969.40000000037252903, 394999.5 6272975))'), loads('Polygon Z ((395007.29999999998835847 6272975.79999999981373549, 395013.20000000001164153 6272981, 395021.20000000001164153 6272969.59999999962747097, 395024.20000000001164153 6272971.90000000037252903, 395031 6272963.79999999981373549, 395020.79999999998835847 6272957.40000000037252903, 395007.29999999998835847 6272975.79999999981373549))'), loads('Polygon Z ((395082.29999999998835847 6272967.40000000037252903, 395089.90000000002328306 6272958, 395071.90000000002328306 6272945.90000000037252903, 395068.40000000002328306 6272950.59999999962747097, 395066 6272949, 395056.29999999998835847 6272962, 395058.5 6272963.5, 395056.40000000002328306 6272966.79999999981373549, 395059.40000000002328306 6272969.90000000037252903, 395056.90000000002328306 6272972.59999999962747097, 395054.5 6272968.29999999981373549, 395049.59999999997671694 6272973.40000000037252903, 395058.40000000002328306 6272981.59999999962747097, 395073.59999999997671694 6272962.5, 395082.29999999998835847 6272967.40000000037252903))')]

fig = plt.figure(1)
sub1 = fig.add_subplot(111)
sub1.axes.get_xaxis().set_visible(False)
sub1.axes.get_yaxis().set_visible(False)

for building in buildings:
    simplified = c4.building_simplification_ruas(building, 5.0)
    poly1 = Path.make_compound_path(Path(numpy.asarray(building.exterior.coords)[:, :2]),*[Path(numpy.asarray(ring.coords)[:, :2]) for ring in building.interiors])
    poly2 = Path.make_compound_path(Path(numpy.asarray(simplified.exterior.coords)[:, :2]),*[Path(numpy.asarray(ring.coords)[:, :2]) for ring in simplified.interiors])
    sub1.add_patch(PathPatch(poly1, facecolor="gray", edgecolor='none'))
    sub1.add_patch(PathPatch(poly2, facecolor="none", edgecolor='red', linewidth=1))

sub1.autoscale_view()
plt.show()