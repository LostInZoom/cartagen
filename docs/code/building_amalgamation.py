from matplotlib import pyplot as plt
import cartagen as c4
import geopandas as gp
from shapely.wkt import loads

geoms = [loads('Polygon Z ((802770.59999999997671694 6725675.29999999981373549 218.09999999999999432, 802767.30000000004656613 6725677.20000000018626451 218.09999999999999432, 802770 6725683 218.09999999999999432, 802768.30000000004656613 6725683.90000000037252903 218.09999999999999432, 802770.59999999997671694 6725689 218.09999999999999432, 802776.19999999995343387 6725686.5 218.09999999999999432, 802770.59999999997671694 6725675.29999999981373549 218.09999999999999432))'),
            loads('Polygon Z ((802777 6725690.29999999981373549 220.59999999999999432, 802769.80000000004656613 6725693.40000000037252903 220.59999999999999432, 802774 6725703.40000000037252903 220.59999999999999432, 802778.19999999995343387 6725701.79999999981373549 220.59999999999999432, 802781.69999999995343387 6725700.40000000037252903 220.59999999999999432, 802777.90000000002328306 6725690 220.59999999999999432, 802777 6725690.29999999981373549 220.59999999999999432))'),
            loads('Polygon Z ((802781.69999999995343387 6725700.40000000037252903 221.19999999999998863, 802778.19999999995343387 6725701.79999999981373549 221.19999999999998863, 802779.80000000004656613 6725706 221.19999999999998863, 802775.80000000004656613 6725707.59999999962747097 221.19999999999998863, 802776.30000000004656613 6725708.79999999981373549 221.19999999999998863, 802776.59999999997671694 6725709.70000000018626451 221.19999999999998863, 802784 6725706.70000000018626451 221.19999999999998863, 802781.69999999995343387 6725700.40000000037252903 221.19999999999998863))'),
            loads('Polygon Z ((802784 6725706.70000000018626451 221.5, 802776.59999999997671694 6725709.70000000018626451 221.5, 802779.80000000004656613 6725718.70000000018626451 221.5, 802789.80000000004656613 6725715.70000000018626451 221.5, 802788.30000000004656613 6725709.90000000037252903 221.5, 802787 6725710.29999999981373549 221.5, 802785.5 6725710.79999999981373549 221.5, 802784 6725706.70000000018626451 221.5))'),
            loads('Polygon Z ((802789.80000000004656613 6725715.70000000018626451 221.69999999999998863, 802779.80000000004656613 6725718.70000000018626451 221.69999999999998863, 802777.09999999997671694 6725719.5 221.69999999999998863, 802778.40000000002328306 6725724.09999999962747097 221.69999999999998863, 802781.19999999995343387 6725723.29999999981373549 221.69999999999998863, 802782.59999999997671694 6725728 221.69999999999998863, 802782.90000000002328306 6725727.90000000037252903 221.69999999999998863, 802792.19999999995343387 6725725.20000000018626451 221.69999999999998863, 802789.80000000004656613 6725715.70000000018626451 221.69999999999998863))'),
            loads('Polygon Z ((802792.19999999995343387 6725725.20000000018626451 221.90000000000000568, 802782.90000000002328306 6725727.90000000037252903 221.90000000000000568, 802782.59999999997671694 6725728 221.90000000000000568, 802784.69999999995343387 6725735.40000000037252903 221.90000000000000568, 802787.69999999995343387 6725734.59999999962747097 221.90000000000000568, 802789 6725738.59999999962747097 221.90000000000000568, 802795.19999999995343387 6725737.59999999962747097 221.90000000000000568, 802792.19999999995343387 6725725.20000000018626451 221.90000000000000568))'),
            loads('Polygon Z ((802769.30000000004656613 6725716.29999999981373549 221.19999999999998863, 802776.69999999995343387 6725714.09999999962747097 221.19999999999998863, 802775.59999999997671694 6725710.09999999962747097 221.19999999999998863, 802774.90000000002328306 6725707.90000000037252903 221.19999999999998863, 802767.59999999997671694 6725710.20000000018626451 221.19999999999998863, 802768.40000000002328306 6725712.90000000037252903 221.19999999999998863, 802769.30000000004656613 6725716.29999999981373549 221.19999999999998863))'),
            loads('Polygon Z ((802769.30000000004656613 6725716.29999999981373549 218.40000000000000568, 802768.40000000002328306 6725712.90000000037252903 218.40000000000000568, 802762.5 6725714.70000000018626451 218.40000000000000568, 802754 6725717.20000000018626451 218.40000000000000568, 802755.09999999997671694 6725720.5 218.40000000000000568, 802769.30000000004656613 6725716.29999999981373549 218.40000000000000568))')]
    
aggregation = c4.morphological_amalgamation(geoms, 1.0, 1.0)

p1 = gp.GeoSeries(geoms)
p2 = gp.GeoSeries(aggregation)

base = p1.plot(facecolor='gray', edgecolor='none')
p2.plot(ax=base, facecolor='none', edgecolor='red')

base.set_title('Morphological amalgamation (Damen et al., 2008)', pad=10, family='sans-serif')
base.axes.get_xaxis().set_visible(False)
base.axes.get_yaxis().set_visible(False)
plt.show()